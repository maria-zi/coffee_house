# Тестовая база данных "coffee_house"

Этот репозиторий содержит тестовую базу данных "coffee_house", созданную для демонстрации функционала баз данных кофейни.

## Описание

База данных "coffee_house" моделирует работу кофейни, включая информацию о продукции, заказах, клиентах и т.д. Она предоставляет простую схему данных для тестирования и демонстрации различных запросов и операций баз данных.

## Структура базы данных

- `order_list`: информация о заказах, включая id заказа, id продукта, количество продуктов в заказе.
- `order_staff`: данные о персонале.
- `clients`: данные о клиентах, включая имя, контактную информацию и т.д.
- `delivery`: информация о доставке заказов.
- `ingredients`: информация об ингредиентах для приготовления продукции.
- `menu`: меню кофейни с информацией о продукции.
- `providers`: данные о поставщиках ингредиентов.
- `staff`: информация о сотрудниках кофейни.
- `supply`: информация о поставках ингредиентов.


## Использование (???)



## Примеры запросов

1. Вывести все продукты, имеющиеся в наличии:

SELECT * FROM menu;

2. Получить суммарное количество поставок молока за каждую дату поставки из таблицы `supply`. 

SELECT sup_date, ing_name, sup_quantity, SUM(sup_quantity) AS sum
FROM supply AS s
JOIN ingredients AS i ON s.sup_ingredient = i.ing_id
WHERE ing_name = 'milk'
GROUP BY sup_date, ing_name, sup_quantity;

## Пример процедуры

CREATE PROCEDURE insert_order(a TIMESTAMP, b integer, c integer, d integer, e integer, f integer, g integer, h integer, i integer)
LANGUAGE SQL
AS $$
INSERT INTO orders (ord_date_time, ord_cli_id) VALUES (a, b); -- для даты и клиента заказа
INSERT INTO order_list (ord_id, prod_id, prod_quantity) VALUES (c, d, e); --для номера заказа, продукта в заказе и количества продукта (для заказа с одним продуктом)
INSERT INTO order_staff (id_ord, id_staff) VALUES (f, g); -- для добавления бариста
INSERT INTO order_staff (id_ord, id_staff) VALUES (h, i); -- для добавления клинера
$$;

Эта SQL-процедура предназначена для добавления нового заказа в базу данных. Она принимает следующие параметры:

- `a`: дата и время заказа (`TIMESTAMP`);
- `b`: идентификатор клиента (`integer`);
- `c`: номер заказа (`integer`);
- `d`: идентификатор продукта в заказе (`integer`);
- `e`: количество продукта в заказе (`integer`);
- `f`: идентификатор баристы (`integer`);
- `g`: идентификатор клинера (`integer`);
- `h`: идентификатор баристы (если применимо) (`integer`);
- `i`: идентификатор клинера (если применимо) (`integer`).

Процедура выполняет следующие действия:
1. Добавляет информацию о заказе в таблицу `orders`, включая дату и время заказа и идентификатор клиента.
2. Добавляет информацию о продукте в заказе в таблицу `order_list`, включая номер заказа, идентификатор продукта и количество продукта.
3. Добавляет информацию о персонале, занятом на выполнении заказа, в таблицу `order_staff`. В данной версии процедуры предполагается, что заказ обслуживается двумя членами персонала: баристой и клинером. Параметры `f` и `g` используются для добавления идентификаторов баристы и клинера соответственно.

Для вызова этой процедуры используйте следующий синтаксис:

CALL insert_order('2023-10-27 00:00:00', 3, 265, 1, 2, 265, 2, 265, 10);

## Модель базы данных coffee_house, схемы public

![model DB](https://github.com/maria-zi/coffee_house/assets/102587427/fd86b4ad-b723-4a21-b7bb-238ae5617733)

 
